## 🚁 任务四：多单元协同搜索与复杂环境推断

本文档详细介绍了如何将单单元搜索模型（任务三）扩展，以适应**复杂多变的地形环境**和**多单元无人机协同搜索**的需求。模型集成了失事动态模拟、真实地形数据以及先进的路径规划算法（PSO、优化贪婪、遗传算法），旨在最小化在复杂 SAR 场景中的定位时间（TTF）。

## 🎯 核心目标

1.  **环境推断与修正：** 将失事定位模型（P(C)）扩展到不同的复杂地形（如山地、森林、沙漠），并对搜索效率 $k$ 进行修正。
2.  **多单元协同**：开发一个多无人机协同搜索模型，优化单元间的任务分配和覆盖信息共享。
3.  **算法对比**：评估并对比 **PSO**、**优化贪婪搜索 (GOS)** 和 **遗传算法 (GA)** 在多单元协同场景下的性能。

## ⚙️ 模型与参数设计

### 1. 复杂环境建模：地形与搜索效率修正

任务四的核心挑战是引入环境因素对失事定位和搜索效率的影响，这是任务三向真实世界场景推断的关键一步。

#### 1.1. 失事定位 (P(C)) 的复杂地形修正

在复杂地形下，传统的平面模型失效。我们引入真实地形数据进行修正：

* **物理模型：** 模块 `physics_engine.py` 实现了无人机弹道轨迹的分析闭式解公式；`drone_simulation.py` 集成了风场模型和紧急策略模拟。这些模块计算无人机在空气中的轨迹和水平漂移。
* **地形碰撞校正依据 [1]：** 根据 Lin & Goodrich 的研究 [1]，复杂地形是影响野外 SAR 路径规划的首要因素。模型通过 `CrashProbabilityGenerator` 模块，结合 `config.py` 中的 DEM 数据，使用迭代求解过程（`simulator.py`）将轨迹与地形进行碰撞检测，确定**首次接触地形**的精确撞击点 $P_{crash}$，从而修正有效下落高度 $H_{eff}$ 和最终的 P(C) 分布。

#### 1.2. 搜索效率的复杂环境修正

搜索效率 $k$ 值应根据地形导致的遮挡程度进行调整，以推断模型在不同环境下的性能。

* **推断依据 [1]：** Lin & Goodrich [1] 强调了**地形的复杂性**（如植被覆盖、障碍物）对传感器搜索有效性的负面影响。
* **模型实现：** 模型通过对基础 $k$ 值应用**地形因子**（`TERRAIN_FACTORS`）进行修正。例如，在**Mountain\_Forest**（山地森林）地形中，由于植被遮挡，导致 $k$ 值被大幅削弱（$K_{factor} = 0.70$），模拟了识别可靠性的降低。

### 2. 多单元协同搜索规划 (Multi-Unit Cooperative Search)

多单元搜索的核心在于协同规划，以最大化系统的累计探测概率 (CPD)。

#### 2.1. 目标函数与协同机制

多单元系统的 CPD 目标函数保持不变。关键在于**搜索努力的协同累加**：

$$
\text{CPD}(T) = 1 - \exp \left( - \sum_{i \in \text{Grid}} P(C_i) \cdot \sum_{j=1}^{\text{Num Drones}} \text{Effort}_{j \to i} \right)
$$

* **协同机制与信息共享依据 [1] [2]：** 多无人机协同搜索效率的提升，依赖于无人机群对环境和彼此搜索状态的感知。
    * 根据 Lin & Goodrich 的研究 [1]，**实时共享搜索覆盖信息**（即当前累计搜索努力图 $N_{\text{map}}$）是实现有效协同，避免冗余覆盖的关键。
    * 模型采纳了类似 **[2]** 中基于概率图的覆盖搜索框架，确保路径规划基于**实时修正的概率图**，而非静态的 $P(C)$，从而动态消除高价值区域的重复搜索。

#### 2.2. 路径优化算法

模型对比了三种协同路径规划算法，它们在**概率图修正**和**动态适应性**上各有侧重：

| 算法 | 代码函数 | 优化目标与原理 | 协同机制 |
| :--- | :--- | :--- | :--- |
| **PSO** | `pso_search_path` | **全局动态优化**：由粒子群的全局最佳位置 $G_{best}$（当前最高 CPD 增益点）指导路径。 | PSO 的高效性使其在多单元 SAR 动态路径规划中具有优势，其寻优目标与基于**概率图 [2]** 的高信息增益搜索目标一致。 |
| **优化贪婪搜索 (GOS)** | `optimized_greedy_search` | **局部高效率搜索**：每一步选择局部最高概率点。并通过 **GWE (概率衰减)** 模拟已搜索区域被“冷却”的过程。 | 路径选择和概率衰减机制参考了 **[1] [2]** 的思想，即利用共享的概率图动态调整搜索目标，实现局部快速收敛。 |
| **遗传算法 (GA)** | `genetic_path_search` | **路径组合的全局寻优**：通过**交叉**和**变异**操作生成多条路径组合，以最大化路径所覆盖区域的累计概率。 | GA 路径寻优基于 **[2]** 所强调的概率图建模，旨在复杂概率分布下找到最高效的覆盖几何布局。 |

### 3. 多单元部署点确定

采用**K-Means 聚类部署原则**：在 P(C) 图的 95% 分位数高概率区域内，使用 $K$-Means 聚类确定 $N_{\text{drones}}$ 个最佳初始部署点。这确保了无人机队能有效覆盖多个潜在失事热点。

## 📊 结果评估与可视化

任务四的评估着重于算法在复杂环境下的协同效率，采用 **$N_{\text{策略}} \times 4$** 的图表结构：

* **CPD 曲线：** 对比 PSO、GOS、GA 在不同环境下的效率和收敛速度，计算 TTF (Time to Find, 达到目标概率所需的时间)。
* **P(C) 热力图：** 显示带地形修正的失事概率分布和部署点。
* **多单元路径对比图：** **核心图表**。展示所有算法的路径，背景叠加 P(C)，直观对比路径间的差异和协同行为。
* **协同覆盖热力图：** 显示**最优算法**的累积搜索努力（`searched_count_map`），用于评估多单元覆盖的**均匀性和有效性**。

## 📜 参考文献

[1] **Lin, L., & Goodrich, M. A.** (2009). **UAV Intelligent Path Planning for Wilderness Search and Rescue**. *2009 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS)*, 5133-5138.
> **（核心依据：复杂地形与多单元协同）** 强调了**地形因素**对搜索规划的影响，为任务三向任务四的扩展提供了理论支持。同时，提出了多无人机协同搜索中**信息共享**以避免冗余覆盖的必要性。

[2] 吴韬, 陈思恒, 罗泽霖, 等. (2025). **基于概率图的多无人机覆盖搜索路径规划方法**. *信息对抗技术*, 4(4), 30-42.
> **（核心依据：概率图覆盖与路径规划）** 提供了基于**概率图**的覆盖搜索感知模型和动态路径规划方法，为本模型中的 CPD 协同机制、**优化贪婪搜索 (GOS)** 和**遗传算法 (GA)** 路径寻优提供了核心技术路线和理论基础。